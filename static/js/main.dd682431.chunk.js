(this.webpackJsonpflowchart_editor=this.webpackJsonpflowchart_editor||[]).push([[0],{209:function(e,t,n){"use strict";n.r(t);var i,r=n(0),a=n(33),o=n.n(a),c=n(90),s=n(25),d=n(42),h=n(92),l=n(26),u=n(22),g=n(15);function p(e){var t=e.graphRef,n=Object(r.useRef)(null);return Object(r.useEffect)((function(){t.current=new u.c({container:n.current,width:800,height:700,grid:{visible:!0},background:{color:"#F7FBFF"},interacting:{nodeMovable:!1},scroller:{enabled:!0,pageVisible:!0,pageBreak:!0}})}),[]),Object(g.jsx)(f,{ref:n})}var b,j,f=l.b.div(i||(i=Object(s.a)(["\n  border: 1px solid lightgrey;\n  border-right: none;\n"]))),O=n(29),x=n(1),v=n(216),y=n(214);function m(e){var t=e.onDelete,n=e.children,i=Object(r.useRef)();return Object(g.jsxs)(w,{onMouseEnter:function(){i.current.style.display="block"},onMouseLeave:function(){i.current.style.display="none"},children:[n,Object(g.jsx)(k,{onClick:t,ref:i,icon:Object(g.jsx)(v.a,{})})]})}var N,w=l.b.div(b||(b=Object(s.a)(["\n  // border: 3px dashed purple; \n  width: 100%; \n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),k=Object(l.b)(y.a)(j||(j=Object(s.a)(["\n  position: absolute;\n  right: 0%;\n  transform: translateX(15px);\n  width: 2rem;\n  height: 2rem;\n  border-radius: 50%;\n  display: none;\n  transition: 100ms all ease-in-out;\n  border: 1px solid lightgrey;\n  background-color: white;\n  cursor: pointer;\n\n  &:hover {\n    color: #1890FF;\n    border-color: #1890FF;\n  }\n"]))),C=function e(){Object(x.a)(this,e),this.width=250,this.height=70,this.x=250,this.y=125,this.shape="react-shape",this.id="empty",this.component=function(e){return Object(g.jsx)(m,{onDelete:function(){},children:Object(g.jsx)(S,{children:"\u8bf7\u5c06\u5de6\u4fa7\u670d\u52a1\u6216\u5173\u7cfb\u62d6\u5165\u6846\u5185"})})}},E=function e(t,n){Object(x.a)(this,e),this.width=250,this.height=70,this.x=t,this.y=250,this.shape="react-shape",this.id=n,this.component=function(e){return Object(g.jsx)(m,{children:Object(g.jsx)(S,{children:"\u8bf7\u5c06\u5de6\u4fa7\u670d\u52a1\u62d6\u5165\u6846\u5185"})})}},S=l.b.div(N||(N=Object(s.a)(["\n  width: 80%;\n  height: 100%;\n  border: 2px dashed grey;\n  font-size: small;\n  color: grey;\n  padding: 1px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),_={shape:"circle",width:50,height:50,attrs:{body:{stroke:"lightgrey",strokeWidth:1}}};var F,P,R,B=n(212),I=n(213),V=n(211),L=(n(140),n(127)),M=n(103),W=n(41),D={routeNum:2},A=Object(M.a)("PLUS"),z=Object(M.a)("MINUS"),T=Object(W.d)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A.type:return{routeNum:e.routeNum+1,action:"plus"};case z.type:return{routeNum:e.routeNum-1,action:"minus"};default:return e}})),G=B.a.SubMenu;var H,U,J=Object(c.b)((function(e,t){return{state:e}}))((function(e){var t=Object(r.useState)("\u5408\u5e76\u901a\u884c(JoinAll)"),n=Object(d.a)(t,2),i=(n[0],n[1],T.getState().routeNum);return Object(g.jsxs)(K,{children:[Object(g.jsx)(X,{children:"\u5173\u7cfb\u914d\u7f6e"}),Object(g.jsx)(B.a,{defaultOpenKeys:["sub_pass","sub_route"],mode:"inline",children:Object(g.jsx)(G,{title:"\u8def\u7ebf",icon:Object(g.jsx)(L.a,{}),children:Object(g.jsxs)(B.a.Item,{children:["\u7ebf\u8def\u6570:",Object(g.jsx)(I.a,{min:2,defaultValue:2,onChange:function(e){i<e?T.dispatch({type:"PLUS"}):i>e&&T.dispatch({type:"MINUS"}),i=e}})]},"route")},"sub_route")})]})})),K=l.b.div(F||(F=Object(s.a)(["\n\twidth: 400px;\n\theight: 700px;\n\tborder: 1px solid lightgrey;\n"]))),X=l.b.div(P||(P=Object(s.a)(["\n\theight: 45px;\n\tpadding: 10px 20px;\n\tborder-bottom: 1px solid lightgrey;\n"]))),Z=(Object(l.b)(V.a)(R||(R=Object(s.a)(["\n\tpadding: 4px 16px;\n\tbackground: white;\n"]))),n(78)),q=n(2);function Q(e){var t=e.fillColor,n=e.strokeColor,i=e.strokeWidth,r=e.children;return Object(g.jsxs)(ne,{children:[Object(g.jsx)("svg",{width:"100%",height:"100%",viewBox:"0 0 111 44",children:Object(g.jsx)("g",{transform:"matrix(1,0,0,1,-386.202,-492.831)",children:Object(g.jsx)("g",{transform:"matrix(1,0,0,1.07965,3.97193,-33.3985)",children:Object(g.jsx)("path",{d:"M402.079,526.733L383.272,507.553L402.079,488.373L472.937,488.373L491.744,507.553L472.937,526.733L402.079,526.733Z",style:{fill:t,stroke:n,strokeWidth:i}})})})}),Object(g.jsx)(ie,{children:r})]})}var Y,$,ee,te,ne=l.b.div(H||(H=Object(s.a)(["\n\twidth: 100%;\n\theight: 100%;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n"]))),ie=l.b.span(U||(U=Object(s.a)(["\n\tposition: absolute;\n"]))),re=function e(t,n){Object(x.a)(this,e);var i=t.position(),r=i.x,a=i.y,o=t.size().width;this.width=210,this.height=50,this.x=r+(o-this.width)/2,this.y=a,this.shape="react-shape",this.id="polygonStartNode",this.component=function(e){return Object(g.jsx)(m,{onDelete:function(){return n(e)},children:Object(g.jsx)(Q,{fillColor:"none",strokeColor:"#1890FF",strokeWidth:"1px",children:"\u5e76\u884c\u5f00\u59cb"})})}},ae=function e(t){Object(x.a)(this,e);var n=t.position(),i=n.x,r=n.y,a=t.size().width;this.width=210,this.height=50,this.x=i+(a-this.width)/2,this.y=r+270,this.shape="react-shape",this.id="polygonFinishNode",this.component=Object(g.jsx)(Q,{fillColor:"none",strokeColor:"#1890FF",strokeWidth:"1px",children:"\u5e76\u884c\u7ed3\u675f"})},oe=function e(t,n,i){Object(x.a)(this,e);var r=t.position(),a=r.x,o=r.y,c=t.size().width;this.shape="react-shape",this.width=220,this.height=35,this.x=a+(c-this.width)/2,this.y=o,this.id="".concat(t.id,"_Service"),this.component=function(e){return Object(g.jsx)(m,{onDelete:function(){return i(e)},children:Object(g.jsx)(ce,{children:n})})}},ce=l.b.div(Y||(Y=Object(s.a)(["\n  width: 170px;\n  height: 35px;\n  background: white;\n  border: 1px solid #1890FF;\n  color: black;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 30px;\n"]))),se=new(function(){function e(){Object(x.a)(this,e),this.containerNode=null}return Object(q.a)(e,[{key:"validateNode",value:function(e,t,n){this.graph=n;var i,r=Object(Z.a)(n.getNodes());try{for(r.s();!(i=r.n()).done;){var a=i.value;if("empty"===a.id){var o=a.getBBox();if(e.getBBox().isIntersectWithRect(o)&&0===a.getChildCount()){var c=e.getData(),s=c.title,d=c.group;return"service"===d?this.addServiceNode(a,s):"relation"===d&&this.addParallelNode(a),n.removeNode(a),!1}}else if(a.id.includes("emptyParallel_")){var h=a.getBBox();if(e.getBBox().isIntersectWithRect(h)&&0===a.getChildCount()){var l=e.getData(),u=l.title,g=l.group;return"service"===g?(this.addServiceNode(a,u),n.removeNode(a)):"relation"===g&&alert("Only Service Node is available at here."),!1}}}}catch(p){r.e(p)}finally{r.f()}return!1}},{key:"addServiceNode",value:function(e,t){var n=this,i=new oe(e,t,(function(e){return n.deleteServiceNode(e)})),r=this.graph.addNode(i),a=this.graph.getIncomingEdges(e)[0],o=this.graph.getOutgoingEdges(e)[0];a.setTarget(r),o.setSource(r),"empty"!==e.id&&this.graph.trigger("AddParallelService",r)}},{key:"addParallelNode",value:function(e){var t=this;this.containerNode=this.graph.addNode({id:"container_node",width:100,height:100});for(var n=new re(e,(function(e){return t.deleteParalleleNode(e,a)})),i=new ae(e),r=this.graph.addNode(n),a=this.graph.addNode(i),o=2,c=[],s=[],d=[],h={router:"orth",attrs:{line:{stroke:"#1890FF",sourceMarker:"circle"}}},l=0;l<2;l++)c.push(this.graph.addNode(new E(120+260*l,"emptyParallel_".concat(l)))),s.push(this.graph.addEdge(Object(O.a)(Object(O.a)({},h),{},{id:"upEdge_".concat(l),source:r,target:c[l],vertices:[{x:245+260*l,y:220}]}))),d.push(this.graph.addEdge(Object(O.a)(Object(O.a)({},h),{},{id:"downEdge_".concat(l),source:c[l],target:a,vertices:[{x:310+130*l,y:350}]}))),this.containerNode.addChild(c[l]),this.containerNode.addChild(s[l]),this.containerNode.addChild(d[l]);T.subscribe((function(){var e=(o=T.getState().routeNum)-1,n=T.getState().action;if("plus"===n){for(var i=0;i<e;i++){c[i].translate(-130,void 0);var l=s[i].getVertices()[0].x,u=d[i].getVertices()[0].x;s[i].setVertices([{x:l-130,y:220}]),d[i].setVertices([{x:u-65,y:350}])}c.push(t.graph.addNode(new E(120+260*e-130*(o-2),"emptyParallel_".concat(e)))),s.push(t.graph.addEdge(Object(O.a)(Object(O.a)({},h),{},{id:"upEdge_".concat(e),source:r,target:c[e],vertices:[{x:245+260*e-130*(o-2),y:220}]}))),d.push(t.graph.addEdge(Object(O.a)(Object(O.a)({},h),{},{id:"downEdge_".concat(e),source:c[e],target:a,vertices:[{x:310+130*e-65*(o-2),y:350}]}))),t.containerNode.addChild(c[e]),t.containerNode.addChild(s[e]),t.containerNode.addChild(d[e])}else if("minus"===n){for(var g=0;g<o;g++){c[g].translate(130,void 0);var p=s[g].getVertices()[0].x,b=d[g].getVertices()[0].x;s[g].setVertices([{x:p+130,y:220}]),d[g].setVertices([{x:b+65,y:350}])}c.pop(),s.pop(),d.pop(),t.graph.removeNode("emptyParallel_".concat(o))}}));var u=this.graph.getIncomingEdges(e)[0],g=this.graph.getOutgoingEdges(e)[0];u.setTarget(r),g.setSource(a),this.containerNode.addChild(r),this.containerNode.addChild(a),this.graph.on("AddParallelService",(function(e){t.containerNode.addChild(e)})),this.graph.trigger("AddParallel")}},{key:"deleteServiceNode",value:function(e){var t=e.position().x,n=e.id,i=null;if("empty_Service"===n)i=this.graph.addNode(new C);else if(n.includes("emptyParallel_")){var r=n.slice(14,15);i=this.graph.addNode(new E(t-15,"emptyParallel_".concat(r))),this.containerNode.addChild(i)}this.graph.getIncomingEdges(e)[0].setTarget(i),this.graph.getOutgoingEdges(e)[0].setSource(i),this.graph.removeNode(e)}},{key:"deleteParalleleNode",value:function(e,t){var n=this.graph.addNode(new C);this.graph.getIncomingEdges(e)[0].setTarget(n),this.graph.getOutgoingEdges(t)[0].setSource(n),this.graph.removeNode(this.containerNode),this.graph.trigger("DeleteParallel")}}]),e}()),de=n(3),he=n(4),le=function(){function e(){Object(x.a)(this,e),this.titles=[],this.groupName="",this.Component=Object(g.jsx)(g.Fragment,{})}return Object(q.a)(e,[{key:"init",value:function(e){this.nodes=[];for(var t=0;t<this.titles.length;t++){var n=this.titles[t],i=new h.a({width:170,height:35,data:{title:n,group:e},shape:"react-shape",component:Object(g.jsx)(this.Component,{children:n})});this.nodes.push(i)}}},{key:"load",value:function(e){e.load(this.nodes,this.groupName)}}]),e}(),ue=function(e){Object(de.a)(n,e);var t=Object(he.a)(n);function n(e){var i;return Object(x.a)(this,n),(i=t.call(this)).titles=e,i.groupName="\u5173\u7cfb\u8282\u70b9",i.Component=ge,i.init("relation"),i}return n}(le),ge=l.b.div($||($=Object(s.a)(["\n  width: 100%;\n  height: 100%;\n  background: white;\n  border: 2px dashed lightgrey;\n  color: black;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 5px;\n"]))),pe=function(e){Object(de.a)(n,e);var t=Object(he.a)(n);function n(e){var i;return Object(x.a)(this,n),(i=t.call(this)).titles=e,i.groupName="\u8baf\u98de\u670d\u52a1",i.Component=be,i.init("service"),i}return n}(le),be=l.b.div(ee||(ee=Object(s.a)(["\n  width: 100%;\n  height: 100%;\n  background: white;\n  border: 1px solid lightgrey;\n  color: black;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 30px;\n"])));function je(e){var t=e.graphRef,n=e.stencilRef,i=e.relations,a=e.services,o=Object(r.useRef)(null);return Object(r.useEffect)((function(){if(t.current){var e=new u.a.Stencil({title:"Components",target:t.current,search:function(e,t){return-1!==e.shape.indexOf(t)},placeholder:"\u5168\u90e8\u670d\u52a1/\u8282\u70b9",notFoundText:"Not Found",collapsable:!0,stencilGraphWidth:230,stencilGraphHeight:100,layoutOptions:{columns:1,dx:0,dy:0,center:!0,columnWidth:200,rowHeight:50},stencilGraphOptions:{background:{color:"#ffffff"}},groups:[{name:"\u5173\u7cfb\u8282\u70b9",title:"\u5173\u7cfb\u8282\u70b9"},{name:"\u8baf\u98de\u670d\u52a1",title:"\u8baf\u98de\u670d\u52a1",graphHeight:300}],validateNode:function(e,n){return se.validateNode(e,n,t.current)}});n.current=e,o.current.appendChild(e.container),new pe(a).load(e),new ue(i).load(e)}}),[]),Object(g.jsx)(xe,{ref:o})}var fe,Oe,xe=l.b.div(te||(te=Object(s.a)(["\n  width: 230px;\n  border: 1px solid #f0f0f0;\n  position: relative; /* !!! */\n"])));function ve(e){var t=e.relations,n=e.services,i=Object(h.b)("GRAPH_1"),a=Object(d.a)(i,2),o=a[0],c=a[1],s=Object(r.useRef)(null),l=Object(r.useRef)(null);return Object(r.useEffect)((function(){!function(e){var t=e.addNode(Object(O.a)(Object(O.a)({},_),{},{x:350,y:30,id:"source",attrs:{label:{text:"\u5f00\u59cb"}}})),n=e.addNode(Object(O.a)(Object(O.a)({},_),{},{x:350,y:140,id:"target",attrs:{label:{text:"\u7ed3\u675f"}}}));e.on("AddParallel",(function(){n.translate(void 0,250)})),e.on("DeleteParallel",(function(){n.translate(void 0,-250)}));var i=e.addNode(Object(O.a)(Object(O.a)({},_),{},{id:"plus",x:367,y:80,width:13,height:13,attrs:{label:{text:"+"}}})),r={attrs:{line:{stroke:"#1890FF",sourceMarker:"circle"}}};e.addEdge(Object(O.a)(Object(O.a)({},r),{},{id:"edge_init",source:i,target:n})),e.on("node:click",(function(a){if("plus"===a.node.id){e.removeNode("edge_init");var o=e.addNode(new C);n.translate(void 0,100),i.hide(),e.addEdge(Object(O.a)(Object(O.a)({},r),{},{id:"upEdge_init",source:t,target:o})),e.addEdge(Object(O.a)(Object(O.a)({},r),{},{id:"downEdge_init",source:o,target:n}))}}))}(s.current),c(s.current)}),[o]),Object(g.jsxs)(me,{children:[Object(g.jsx)(ye,{}),Object(g.jsx)(J,{}),Object(g.jsx)(p,{graphRef:s}),Object(g.jsx)(je,{graphRef:s,stencilRef:l,relations:t,services:n})]})}var ye=Object(l.a)(fe||(fe=Object(s.a)(["\n  * {\n    box-sizing: border-box;\n    padding: 0;\n    margin: 0;\n  }\n"]))),me=l.b.div(Oe||(Oe=Object(s.a)(["\n  display: flex;\n  justify-content: center;\n  flex-direction: row-reverse;\n  width: 100%;\n"])));function Ne(){return Object(g.jsx)(ve,{relations:["\u5e76\u884c\u8282\u70b9","\u6761\u4ef6\u8282\u70b9"],services:["\u4eba\u8138\u76f8\u5173\u80fd\u529b","text_lang","\u6587\u672c\u6821\u5bf9","IFOCR","\u6d4b\u8bd5\u81ea\u5b9a\u4e49\u7528\u4f8b"]})}o.a.render(Object(g.jsx)(c.a,{store:T,children:Object(g.jsx)(Ne,{})}),document.getElementById("root"))}},[[209,1,2]]]);
//# sourceMappingURL=main.dd682431.chunk.js.map